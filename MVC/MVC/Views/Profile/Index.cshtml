@model MVC.Models.ProfileView

<div class="d-flex justify-content-center" style="font-size: 48px; margin-top: 20px;">
    <h2>
        @if (!Model.HasSentRequest && !Model.IsFriend && !Model.HasPendingRequest)
        {
            <!-- If no request is sent, show the friend request button -->
            <form method="post" asp-action="SendFriendRequest" asp-controller="Home" style="display: inline;">
                <input type="hidden" name="username" value="@Model.Username" />
                <button type="submit" class="btn btn-primary" title="Friend request">
                    <i class="fas fa-plus-circle" style="font-size: 24px;"></i>
                </button>
            </form>
        }

        @Model.Username

        <!-- Invite to game button -->
        <form method="post" asp-action="InviteToGame" asp-controller="Home" style="display: inline;">
            <input type="hidden" name="username" value="@Model.Username" />
            <button type="submit" class="btn btn-link p-0" title="Invite to Game">
                <i class="fa fa-envelope" style="font-size: 24px;"></i>
            </button>
        </form>
    </h2>
</div>

<div class="text-center">
    <h3>@Model.Stats</h3>
</div>

<div class="text-center" style="font-size: 48px; margin-top: 20px;">
    <h3>Match History</h3>
</div>
@if (Model.MatchHistory != null && Model.MatchHistory.Count > 0)
{
    <div class="d-flex justify-content-center">
        <div class="col-md-6" style="height: 200px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px;">
            <ul style="list-style: none; padding-left: 0;">
                @foreach (var game in Model.MatchHistory)
                {
                    <li style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;
                        background-color: @(Model.Username == game.Winner ? "#d4edda" : Model.Username == game.Loser ? "#f8d7da" : "#fff3cd"); padding: 10px;">

                        @if (Model.Username == game.Winner)
                        {
                            <span>Won</span>
                        }
                        else if (Model.Username == game.Loser)
                        {
                            <span>Lost</span>
                        }
                        else
                        {
                            <span>Draw</span>
                        }

                        @if (Model.Username == game.Winner)
                        {
                            <span><a asp-controller="Profile" asp-action="Index" asp-route-username="@game.Loser">@game.Loser</a></span>
                        }
                        else if (Model.Username == game.Loser)
                        {
                            <span><a asp-controller="Profile" asp-action="Index" asp-route-username="@game.Winner">@game.Winner</a></span>
                        }
                        else
                        {
                            <span><a asp-controller="Profile" asp-action="Index" asp-route-username="@game.Draw">@game.Draw</a></span>
                        }
                    </li>
                }
            </ul>
        </div>
    </div>
}
else
{
    <p class="text-center">No match history available.</p>
}

<div class="text-center" style="margin-top: 20px;">
    @if (Model.IsFriend)
    {
        <!-- If they are friends, show the delete button -->
        <form method="post" asp-action="DeleteFriend" asp-controller="Home" style="display: inline;">
            <input type="hidden" name="username" value="@Model.Username" />
            <button type="submit" class="btn btn-danger" title="Remove friend">
                <i class="fas fa-trash-alt" style="font-size: 24px;"></i>
            </button>
        </form>
    }
    else if (Model.HasPendingRequest)
    {
        <!-- If the user has a pending request, show accept/decline buttons -->
        <form method="post" asp-action="AcceptFriendRequest" asp-controller="Home" style="display: inline;">
            <input type="hidden" name="username" value="@Model.Username" />
            <button type="submit" class="btn btn-success" title="Accept request">
                <i class="fas fa-check-circle" style="font-size: 24px;"></i>
            </button>
        </form>
        <form method="post" asp-action="DeclineFriendRequest" asp-controller="Home" style="display: inline;">
            <input type="hidden" name="username" value="@Model.Username" />
            <button type="submit" class="btn btn-danger" title="Decline request">
                <i class="fas fa-times-circle" style="font-size: 24px;"></i>
            </button>
        </form>
    }
</div>